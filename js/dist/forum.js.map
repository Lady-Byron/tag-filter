{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorRuntime.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regenerator.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/OverloadYield.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorAsyncIterator.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/regenerator/index.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorAsyncGen.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorDefine.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/typeof.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorValues.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorKeys.js","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/regeneratorAsync.js","webpack://lady-byron-tag-filter/webpack/bootstrap","webpack://lady-byron-tag-filter/webpack/runtime/compat get default export","webpack://lady-byron-tag-filter/webpack/runtime/define property getters","webpack://lady-byron-tag-filter/webpack/runtime/hasOwnProperty shorthand","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['forum/app']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/extend']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/components/Button']\"","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/components/Modal']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['common/utils/classList']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['tags/common/utils/sortTags']\"","webpack://lady-byron-tag-filter/external root \"flarum.core.compat['tags/common/helpers/tagIcon']\"","webpack://lady-byron-tag-filter/./src/forum/components/TagChip.tsx","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://lady-byron-tag-filter/./src/forum/util/categories.ts","webpack://lady-byron-tag-filter/./src/forum/util/query.ts","webpack://lady-byron-tag-filter/./src/forum/components/TagFilterModal.tsx","webpack://lady-byron-tag-filter/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://lady-byron-tag-filter/./src/forum/util/tags.ts","webpack://lady-byron-tag-filter/./src/forum/index.tsx"],"sourcesContent":["var OverloadYield = require(\"./OverloadYield.js\");\nvar regenerator = require(\"./regenerator.js\");\nvar regeneratorAsync = require(\"./regeneratorAsync.js\");\nvar regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nvar regeneratorKeys = require(\"./regeneratorKeys.js\");\nvar regeneratorValues = require(\"./regeneratorValues.js\");\nfunction _regeneratorRuntime() {\n  \"use strict\";\n\n  var r = regenerator(),\n    e = r.m(_regeneratorRuntime),\n    t = (Object.getPrototypeOf ? Object.getPrototypeOf(e) : e.__proto__).constructor;\n  function n(r) {\n    var e = \"function\" == typeof r && r.constructor;\n    return !!e && (e === t || \"GeneratorFunction\" === (e.displayName || e.name));\n  }\n  var o = {\n    \"throw\": 1,\n    \"return\": 2,\n    \"break\": 3,\n    \"continue\": 3\n  };\n  function a(r) {\n    var e, t;\n    return function (n) {\n      e || (e = {\n        stop: function stop() {\n          return t(n.a, 2);\n        },\n        \"catch\": function _catch() {\n          return n.v;\n        },\n        abrupt: function abrupt(r, e) {\n          return t(n.a, o[r], e);\n        },\n        delegateYield: function delegateYield(r, o, a) {\n          return e.resultName = o, t(n.d, regeneratorValues(r), a);\n        },\n        finish: function finish(r) {\n          return t(n.f, r);\n        }\n      }, t = function t(r, _t, o) {\n        n.p = e.prev, n.n = e.next;\n        try {\n          return r(_t, o);\n        } finally {\n          e.next = n.n;\n        }\n      }), e.resultName && (e[e.resultName] = n.v, e.resultName = void 0), e.sent = n.v, e.next = n.n;\n      try {\n        return r.call(this, e);\n      } finally {\n        n.p = e.prev, n.n = e.next;\n      }\n    };\n  }\n  return (module.exports = _regeneratorRuntime = function _regeneratorRuntime() {\n    return {\n      wrap: function wrap(e, t, n, o) {\n        return r.w(a(e), t, n, o && o.reverse());\n      },\n      isGeneratorFunction: n,\n      mark: r.m,\n      awrap: function awrap(r, e) {\n        return new OverloadYield(r, e);\n      },\n      AsyncIterator: regeneratorAsyncIterator,\n      async: function async(r, e, t, o, u) {\n        return (n(e) ? regeneratorAsyncGen : regeneratorAsync)(a(r), e, t, o, u);\n      },\n      keys: regeneratorKeys,\n      values: regeneratorValues\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regeneratorRuntime, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction _regenerator() {\n  /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */\n  var e,\n    t,\n    r = \"function\" == typeof Symbol ? Symbol : {},\n    n = r.iterator || \"@@iterator\",\n    o = r.toStringTag || \"@@toStringTag\";\n  function i(r, n, o, i) {\n    var c = n && n.prototype instanceof Generator ? n : Generator,\n      u = Object.create(c.prototype);\n    return regeneratorDefine(u, \"_invoke\", function (r, n, o) {\n      var i,\n        c,\n        u,\n        f = 0,\n        p = o || [],\n        y = !1,\n        G = {\n          p: 0,\n          n: 0,\n          v: e,\n          a: d,\n          f: d.bind(e, 4),\n          d: function d(t, r) {\n            return i = t, c = 0, u = e, G.n = r, a;\n          }\n        };\n      function d(r, n) {\n        for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) {\n          var o,\n            i = p[t],\n            d = G.p,\n            l = i[2];\n          r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0));\n        }\n        if (o || r > 1) return a;\n        throw y = !0, n;\n      }\n      return function (o, p, l) {\n        if (f > 1) throw TypeError(\"Generator is already running\");\n        for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) {\n          i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u);\n          try {\n            if (f = 2, i) {\n              if (c || (o = \"next\"), t = i[o]) {\n                if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\");\n                if (!t.done) return t;\n                u = t.value, c < 2 && (c = 0);\n              } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1);\n              i = e;\n            } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break;\n          } catch (t) {\n            i = e, c = 1, u = t;\n          } finally {\n            f = 1;\n          }\n        }\n        return {\n          value: t,\n          done: y\n        };\n      };\n    }(r, o, i), !0), u;\n  }\n  var a = {};\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n  t = Object.getPrototypeOf;\n  var c = [][n] ? t(t([][n]())) : (regeneratorDefine(t = {}, n, function () {\n      return this;\n    }), t),\n    u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c);\n  function f(e) {\n    return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, regeneratorDefine(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e;\n  }\n  return GeneratorFunction.prototype = GeneratorFunctionPrototype, regeneratorDefine(u, \"constructor\", GeneratorFunctionPrototype), regeneratorDefine(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", regeneratorDefine(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), regeneratorDefine(u), regeneratorDefine(u, o, \"Generator\"), regeneratorDefine(u, n, function () {\n    return this;\n  }), regeneratorDefine(u, \"toString\", function () {\n    return \"[object Generator]\";\n  }), (module.exports = _regenerator = function _regenerator() {\n    return {\n      w: i,\n      m: f\n    };\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports)();\n}\nmodule.exports = _regenerator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _OverloadYield(e, d) {\n  this.v = e, this.k = d;\n}\nmodule.exports = _OverloadYield, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var OverloadYield = require(\"./OverloadYield.js\");\nvar regeneratorDefine = require(\"./regeneratorDefine.js\");\nfunction AsyncIterator(t, e) {\n  function n(r, o, i, f) {\n    try {\n      var c = t[r](o),\n        u = c.value;\n      return u instanceof OverloadYield ? e.resolve(u.v).then(function (t) {\n        n(\"next\", t, i, f);\n      }, function (t) {\n        n(\"throw\", t, i, f);\n      }) : e.resolve(u).then(function (t) {\n        c.value = t, i(c);\n      }, function (t) {\n        return n(\"throw\", t, i, f);\n      });\n    } catch (t) {\n      f(t);\n    }\n  }\n  var r;\n  this.next || (regeneratorDefine(AsyncIterator.prototype), regeneratorDefine(AsyncIterator.prototype, \"function\" == typeof Symbol && Symbol.asyncIterator || \"@asyncIterator\", function () {\n    return this;\n  })), regeneratorDefine(this, \"_invoke\", function (t, o, i) {\n    function f() {\n      return new e(function (e, r) {\n        n(t, i, e, r);\n      });\n    }\n    return r = r ? r.then(f, f) : f();\n  }, !0);\n}\nmodule.exports = AsyncIterator, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// TODO(Babel 8): Remove this file.\n\nvar runtime = require(\"../helpers/regeneratorRuntime\")();\nmodule.exports = runtime;\n\n// Copied from https://github.com/facebook/regenerator/blob/main/packages/runtime/runtime.js#L736=\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  if (typeof globalThis === \"object\") {\n    globalThis.regeneratorRuntime = runtime;\n  } else {\n    Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n  }\n}\n","var regenerator = require(\"./regenerator.js\");\nvar regeneratorAsyncIterator = require(\"./regeneratorAsyncIterator.js\");\nfunction _regeneratorAsyncGen(r, e, t, o, n) {\n  return new regeneratorAsyncIterator(regenerator().w(r, e, t, o), n || Promise);\n}\nmodule.exports = _regeneratorAsyncGen, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _regeneratorDefine(e, r, n, t) {\n  var i = Object.defineProperty;\n  try {\n    i({}, \"\", {});\n  } catch (e) {\n    i = 0;\n  }\n  module.exports = _regeneratorDefine = function regeneratorDefine(e, r, n, t) {\n    function o(r, n) {\n      _regeneratorDefine(e, r, function (e) {\n        return this._invoke(r, n, e);\n      });\n    }\n    r ? i ? i(e, r, {\n      value: n,\n      enumerable: !t,\n      configurable: !t,\n      writable: !t\n    }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2));\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _regeneratorDefine(e, r, n, t);\n}\nmodule.exports = _regeneratorDefine, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports, _typeof(o);\n}\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\nfunction _regeneratorValues(e) {\n  if (null != e) {\n    var t = e[\"function\" == typeof Symbol && Symbol.iterator || \"@@iterator\"],\n      r = 0;\n    if (t) return t.call(e);\n    if (\"function\" == typeof e.next) return e;\n    if (!isNaN(e.length)) return {\n      next: function next() {\n        return e && r >= e.length && (e = void 0), {\n          value: e && e[r++],\n          done: !e\n        };\n      }\n    };\n  }\n  throw new TypeError(_typeof(e) + \" is not iterable\");\n}\nmodule.exports = _regeneratorValues, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _regeneratorKeys(e) {\n  var n = Object(e),\n    r = [];\n  for (var t in n) r.unshift(t);\n  return function e() {\n    for (; r.length;) if ((t = r.pop()) in n) return e.value = t, e.done = !1, e;\n    return e.done = !0, e;\n  };\n}\nmodule.exports = _regeneratorKeys, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var regeneratorAsyncGen = require(\"./regeneratorAsyncGen.js\");\nfunction _regeneratorAsync(n, e, r, t, o) {\n  var a = regeneratorAsyncGen(n, e, r, t, o);\n  return a.next().then(function (n) {\n    return n.done ? n.value : a.next();\n  });\n}\nmodule.exports = _regeneratorAsync, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","function asyncGeneratorStep(n, t, e, r, o, a, c) {\n  try {\n    var i = n[a](c),\n      u = i.value;\n  } catch (n) {\n    return void e(n);\n  }\n  i.done ? t(u) : Promise.resolve(u).then(r, o);\n}\nfunction _asyncToGenerator(n) {\n  return function () {\n    var t = this,\n      e = arguments;\n    return new Promise(function (r, o) {\n      var a = n.apply(t, e);\n      function _next(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n);\n      }\n      function _throw(n) {\n        asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n);\n      }\n      _next(void 0);\n    });\n  };\n}\nexport { _asyncToGenerator as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/common/utils/sortTags'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['tags/common/helpers/tagIcon'];","import tagIcon from 'flarum/tags/common/helpers/tagIcon';\nimport type Tag from 'flarum/tags/common/models/Tag';\n\n/**\n * 彩色+图标的“紧密芯片”\n * - 用 CSS 变量 --tag-title-color 驱动文字着色\n * - 选中且无自定义图标时显示对勾\n * - 加 title 以便悬停查看完整名称/描述\n */\nexport default function TagChip(\n  tag: Tag,\n  opts: { selected?: boolean; onclick?: () => void } = {}\n) {\n  const color = tag.color() || 'var(--tag-color)';\n  const selected = !!opts.selected;\n\n  const name = tag.name() || '';\n  const desc = tag.description() || '';\n  const title = desc ? `${name} — ${desc}` : name;\n\n  return (\n    <button\n      type=\"button\" // 防止提交表单\n      className={'lbtc-tf-Chip Button ' + (selected ? 'is-selected' : '')}\n      style={{ '--tag-title-color': color } as any}\n      title={title}\n      onclick={opts.onclick}\n      data-tag-slug={tag.slug() || ''}\n      data-tag-id={tag.id() || ''}\n    >\n      <span className=\"Button-label\">\n        <i className=\"SelectTagListItem-icon\">\n          {tag.icon()\n            ? tagIcon(tag, { className: 'SelectTagListItem-tagIcon' })\n            : selected\n              ? <i className=\"icon TagIcon fas fa-check SelectTagListItem-checkIcon\" />\n              : tagIcon(tag, { className: 'SelectTagListItem-tagIcon' })}\n        </i>\n        <span className=\"SelectTagListItem-name\">{name}</span>\n        {desc ? <span className=\"SelectTagListItem-description\">{desc}</span> : null}\n      </span>\n    </button>\n  );\n}\n\n","function _extends() {\n  return _extends = Object.assign ? Object.assign.bind() : function (n) {\n    for (var e = 1; e < arguments.length; e++) {\n      var t = arguments[e];\n      for (var r in t) ({}).hasOwnProperty.call(t, r) && (n[r] = t[r]);\n    }\n    return n;\n  }, _extends.apply(null, arguments);\n}\nexport { _extends as default };","import app from 'flarum/forum/app';\nimport type Tag from 'flarum/tags/common/models/Tag';\n\nexport interface ForumTagCategory {\n  id: number;\n  name: string;\n  slug: string | null;\n  order: number | null;\n  tagIds: number[];\n}\n\nconst LS_KEY = 'lbtc.tagfilter.collapsed';\n\nexport function getCategories(): ForumTagCategory[] {\n  const raw = app.forum.attribute('tagCategories') as ForumTagCategory[] | undefined;\n  if (!Array.isArray(raw)) return [];\n  return raw\n    .map((g) => ({ ...g, order: g.order ?? Number.MAX_SAFE_INTEGER, tagIds: g.tagIds || [] }))\n    .sort((a, b) => (a.order! - b.order!) || (a.id - b.id));\n}\n\nexport function pickTagsInCategories(tags: Tag[], cats: ForumTagCategory[]) {\n  const tagById = new Map<number, Tag>(tags.map((t) => [Number(t.id()), t]));\n\n  const grouped = cats\n    .map((g) => {\n      const list = (g.tagIds || []).map((id) => tagById.get(Number(id))).filter(Boolean) as Tag[];\n      return { group: g, tags: list };\n    })\n    .filter((e) => e.tags.length);\n\n  const inGroup = new Set<number>();\n  grouped.forEach((e) => e.tags.forEach((t) => inGroup.add(Number(t.id()))));\n\n  const ungrouped = tags.filter((t) => !inGroup.has(Number(t.id())));\n\n  return { grouped, ungrouped };\n}\n\n// 折叠状态持久化\nexport function loadCollapsed(): Record<string, boolean> {\n  try {\n    const v = localStorage.getItem(LS_KEY);\n    return v ? JSON.parse(v) : {};\n  } catch { return {}; }\n}\nexport function saveCollapsed(map: Record<string, boolean>) {\n  try { localStorage.setItem(LS_KEY, JSON.stringify(map)); } catch {}\n}\n","import app from 'flarum/forum/app';\n\n/**\n * 解析/合成 Flarum 的 q 参数，保留 tag: 语义\n * 约定：tag: 后接 slug（与路由一致）\n */\nexport function getCurrentQ(): string {\n  const p = (app.search && typeof app.search.params === 'function') ? app.search.params() : {};\n  return (p?.q as string) || '';\n}\n\nexport function parseQ(q: string): { rest: string; tagSlugs: string[] } {\n  const parts = (q || '').trim().split(/\\s+/).filter(Boolean);\n  const tags: string[] = [];\n  const restParts: string[] = [];\n\n  for (const p of parts) {\n    const m = /^tag:(.+)$/i.exec(p);\n    if (m) tags.push(m[1]);\n    else restParts.push(p);\n  }\n\n  return { rest: restParts.join(' '), tagSlugs: Array.from(new Set(tags)) };\n}\n\nexport function stringifyQ(parsed: { rest: string; tagSlugs: string[] }): string {\n  const items: string[] = [];\n  if (parsed.rest) items.push(parsed.rest.trim());\n  parsed.tagSlugs.forEach((s) => items.push(`tag:${s}`));\n  return items.join(' ').trim();\n}\n\nexport function toggleTagSlug(rest: string, current: string[], slug: string) {\n  const set = new Set(current);\n  if (set.has(slug)) set.delete(slug);\n  else set.add(slug);\n  return { rest, tagSlugs: Array.from(set) };\n}\n\nexport function clearTagsInQ(q: string) {\n  const { rest } = parseQ(q);\n  return { rest, tagSlugs: [] as string[] };\n}\n","import app from 'flarum/forum/app';\nimport Modal from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\nimport Stream from 'flarum/common/utils/Stream';\nimport classList from 'flarum/common/utils/classList';\nimport sortTags from 'flarum/tags/common/utils/sortTags';\nimport type Tag from 'flarum/tags/common/models/Tag';\n\nimport TagChip from './TagChip';\nimport { getCategories, pickTagsInCategories, loadCollapsed, saveCollapsed } from '../util/categories';\nimport { getCurrentQ, parseQ, stringifyQ } from '../util/query';\n\ntype Vnode = Mithril.Vnode<Record<string, never>, TagFilterModal>;\n\nexport default class TagFilterModal extends Modal {\n  static isDismissibleViaEscKey = true;\n  static isDismissibleViaBackdropClick = true;\n  static isDismissibleViaCloseButton = true;\n\n  private allTags: Tag[] = [];\n  private filter = Stream<string>('');\n  private collapsed: Record<string, boolean> = {};\n  private initialized = false;\n\n  // 本地选择集（实时应用，不关闭弹窗）\n  private localSelected = new Set<string>();\n  // 打开时保留的非 tag: 关键词\n  private initialRest = '';\n  // 防抖\n  private applyTimer: number | null = null;\n\n  className() { return 'lbtc-tf-Modal Modal--large'; }\n  title() { return app.translator.trans('lady-byron-tag-filter.forum.toolbar.button'); }\n\n  oninit(vnode: Vnode) {\n    super.oninit(vnode);\n    this.collapsed = loadCollapsed();\n    this.allTags = app.store.all<Tag>('tags');\n\n    const { rest, tagSlugs } = parseQ(getCurrentQ());\n    this.initialRest = rest;\n    this.localSelected = new Set(tagSlugs);\n  }\n\n  oncreate(vnode: Mithril.VnodeDOM) {\n    super.oncreate(vnode);\n    // 保证 X 永远能关\n    const closeBtn = this.element?.querySelector<HTMLButtonElement>('.Modal-close');\n    if (closeBtn) {\n      if (!closeBtn.getAttribute('type')) closeBtn.setAttribute('type', 'button');\n      closeBtn.onclick = () => app.modal.close();\n    }\n  }\n\n  onremove() { if (this.applyTimer) { clearTimeout(this.applyTimer); this.applyTimer = null; } }\n\n  onsubmit(e: SubmitEvent) { e.preventDefault(); }\n\n  content() {\n    if (!this.allTags.length) return <div className=\"Modal-body\"><LoadingIndicator /></div>;\n\n    const keyword = (this.filter() || '').trim().toLowerCase();\n    const visible = keyword\n      ? this.allTags.filter((t) => (`${t.name()} ${t.description() || ''}`).toLowerCase().includes(keyword))\n      : this.allTags.slice();\n\n    const cats = getCategories();\n\n    if (cats.length) {\n      const { grouped, ungrouped } = pickTagsInCategories(visible, cats);\n\n      if (!this.initialized) {\n        cats.forEach((g) => (this.collapsed[String(g.id)] ??= true));\n        if (ungrouped.length) this.collapsed.__ungrouped__ ??= true;\n        this.initialized = true;\n        saveCollapsed(this.collapsed);\n      }\n\n      const expandAll = () => { cats.forEach((g) => (this.collapsed[String(g.id)] = false)); this.collapsed.__ungrouped__ = false; saveCollapsed(this.collapsed); m.redraw(); };\n      const collapseAll = () => { cats.forEach((g) => (this.collapsed[String(g.id)] = true));  this.collapsed.__ungrouped__ = true;  saveCollapsed(this.collapsed); m.redraw(); };\n\n      const header = this.renderHeader(expandAll, collapseAll);\n      const sections: Mithril.Children[] = [];\n\n      grouped.forEach(({ group, tags }) => {\n        const key = String(group.id);\n        const isCollapsed = !!this.collapsed[key];\n        const sorted = sortTags(tags.slice());\n\n        sections.push(\n          <li\n            key={`g-${key}-header`}\n            className={classList('lbtc-tf-GroupHeader', { collapsed: isCollapsed })}\n            role=\"button\"\n            aria-expanded={!isCollapsed}\n            tabindex=\"0\"\n            onclick={() => this.toggleGroup(key)}\n            onkeydown={(e: KeyboardEvent) => (e.key === 'Enter' || e.key === ' ') && (e.preventDefault(), this.toggleGroup(key))}\n          >\n            <i className=\"fas fa-chevron-down lbtc-tf-GroupHeader-caret\" />\n            {group.name}\n          </li>\n        );\n\n        if (!isCollapsed) {\n          sections.push(\n            <li key={`g-${key}-body`} className=\"lbtc-tf-GroupBody\">\n              {sorted.map((t) => (\n                <span key={`t-${t.id()}`} style={{ display: 'contents' }}>\n                  {TagChip(t, {\n                    selected: this.localSelected.has(t.slug()!),\n                    onclick: () => this.toggleLocalAndApply(t.slug()!), // ★ 实时应用，不关闭\n                  })}\n                </span>\n              ))}\n            </li>\n          );\n        }\n      });\n\n      if (ungrouped.length) {\n        const key = '__ungrouped__';\n        const isCollapsed = !!this.collapsed[key];\n        const sorted = sortTags(ungrouped.slice());\n\n        sections.push(\n          <li\n            key={`g-${key}-header`}\n            className={classList('lbtc-tf-GroupHeader', { collapsed: isCollapsed })}\n            role=\"button\"\n            aria-expanded={!isCollapsed}\n            tabindex=\"0\"\n            onclick={() => this.toggleGroup(key)}\n            onkeydown={(e: KeyboardEvent) => (e.key === 'Enter' || e.key === ' ') && (e.preventDefault(), this.toggleGroup(key))}\n          >\n            <i className=\"fas fa-chevron-down lbtc-tf-GroupHeader-caret\" />\n            {app.translator.trans('lady-byron-tag-filter.forum.grouped.ungrouped')}\n          </li>\n        );\n\n        if (!isCollapsed) {\n          sections.push(\n            <li key={`g-${key}-body`} className=\"lbtc-tf-GroupBody\">\n              {sorted.map((t) => (\n                <span key={`t-${t.id()}`} style={{ display: 'contents' }}>\n                  {TagChip(t, {\n                    selected: this.localSelected.has(t.slug()!),\n                    onclick: () => this.toggleLocalAndApply(t.slug()!),\n                  })}\n                </span>\n              ))}\n            </li>\n          );\n        }\n      }\n\n      return [\n        header,\n        <div className=\"Modal-footer\">\n          <ul className=\"lbtc-tf-GroupList\">{sections}</ul>\n        </div>,\n      ];\n    }\n\n    // —— 无分组回退 ——\n    const header = this.renderHeader();\n    const flat = sortTags(visible.slice());\n    return [\n      header,\n      <div className=\"Modal-footer\">\n        <div className=\"lbtc-tf-GroupBody\">\n          {flat.map((t) => (\n            <span key={`flat-${t.id()}`} style={{ display: 'contents' }}>\n              {TagChip(t, {\n                selected: this.localSelected.has(t.slug()!),\n                onclick: () => this.toggleLocalAndApply(t.slug()!),\n              })}\n            </span>\n          ))}\n        </div>\n      </div>,\n    ];\n  }\n\n  /** 头部：搜索框 + 控制按钮 + 已选反馈（基于 localSelected） */\n  private renderHeader(expandAll?: () => void, collapseAll?: () => void) {\n    const clearLocal = () => { this.localSelected.clear(); this.applyNow({ debounce: 0 }); m.redraw(); };\n\n    // 已选反馈\n    const bySlug = new Map(this.allTags.map((t) => [t.slug()!, t]));\n    const selectedTags = Array.from(this.localSelected).map((s) => bySlug.get(s)).filter(Boolean) as Tag[];\n\n    return (\n      <div className=\"Modal-body\">\n        <div className=\"Form\">\n          <div className=\"Form-group\">\n            <input\n              className=\"FormControl\"\n              placeholder={app.translator.trans('lady-byron-tag-filter.forum.toolbar.placeholder')}\n              bidi={this.filter}\n              oninput={() => m.redraw()}\n            />\n          </div>\n          <div className=\"Form-group\">\n            <div className=\"ButtonGroup\">\n              <Button type=\"button\" className=\"Button\" icon=\"fas fa-eraser\" onclick={clearLocal} disabled={!selectedTags.length}>\n                {app.translator.trans('lady-byron-tag-filter.forum.toolbar.clear')}\n              </Button>\n              {expandAll && collapseAll ? (\n                <>\n                  <Button type=\"button\" className=\"Button\" icon=\"fas fa-angle-down\" onclick={expandAll}>\n                    {app.translator.trans('lady-byron-tag-filter.forum.toolbar.expand_all')}\n                  </Button>\n                  <Button type=\"button\" className=\"Button\" icon=\"fas fa-angle-up\" onclick={collapseAll}>\n                    {app.translator.trans('lady-byron-tag-filter.forum.toolbar.collapse_all')}\n                  </Button>\n                </>\n              ) : null}\n              {/* 统一外观：与其它按钮同色，同样带图标 */}\n              <Button type=\"button\" className=\"Button\" icon=\"fas fa-check\" onclick={() => app.modal.close()}>\n                {app.translator.trans('lady-byron-tag-filter.forum.toolbar.done')}\n              </Button>\n            </div>\n          </div>\n\n          {/* 已选标签（点可取消） */}\n          <div className=\"Form-group\">\n            {selectedTags.length ? (\n              <div className=\"lbtc-tf-GroupBody\">\n                {selectedTags.map((t) =>\n                  <span key={`sel-${t.id()}`} style={{ display: 'contents' }}>\n                    {TagChip(t, { selected: true, onclick: () => this.toggleLocalAndApply(t.slug()!) })}\n                  </span>\n                )}\n              </div>\n            ) : null}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  private toggleGroup(key: string) {\n    this.collapsed[key] = !this.collapsed[key];\n    saveCollapsed(this.collapsed);\n    m.redraw();\n  }\n\n  private toggleLocalAndApply(slug: string) {\n    if (this.localSelected.has(slug)) this.localSelected.delete(slug);\n    else this.localSelected.add(slug);\n    this.applyNow(); // 实时应用\n    m.redraw();\n  }\n\n  /** 核心：用讨论列表状态刷新，不走路由；再用 history.replaceState 同步 URL */\n  private applyNow(opts: { debounce?: number } = {}) {\n    const q = stringifyQ({ rest: this.initialRest, tagSlugs: Array.from(this.localSelected) });\n    const wait = opts.debounce ?? 120;\n\n    const doApply = () => {\n      // 1) 刷新列表（不触发路由，弹窗不会被关闭）\n      const dl: any = (app as any).discussions;\n      if (dl?.refreshParams) {\n        dl.refreshParams({ q });\n      }\n\n      // 2) 同步地址栏但不触发 mithril 路由\n      const params = m.route.param();\n      if (q) params.q = q; else delete params.q;\n      const url = app.route('index', params);\n      try { window.history.replaceState(null, '', url); } catch {}\n\n      // 3) 可选：更新搜索条文本（如果存在）\n      const s: any = (app as any).search;\n      if (s?.setText) s.setText(q);\n    };\n\n    if (this.applyTimer) clearTimeout(this.applyTimer);\n    this.applyTimer = window.setTimeout(() => {\n      this.applyTimer = null;\n      doApply();\n    }, wait);\n  }\n}\n","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","import app from 'flarum/forum/app';\n\ntype ForumTagCategory = {\n  id: number | string;\n  name: string;\n  slug: string | null;\n  order: number | null;\n  tagIds: (number | string)[];\n};\n\nlet warmupPromise: Promise<any> | null = null;\n\n/** 后台预热：把可见标签（含 parent 关系）一次拉进 store；多次调用复用同一 Promise */\nexport function warmupTags() {\n  if (!warmupPromise) {\n    warmupPromise = app.store\n      .find('tags', { include: 'parent', 'page[limit]': 999 })\n      .catch(() => {}); // 静默失败\n  }\n  return warmupPromise;\n}\n\n/** 仅在“分类里需要的 tag”缺失时才触发请求；否则立即返回 */\nexport async function ensureCategoryTagsLoaded() {\n  const cats = (app.forum.attribute('tagCategories') as ForumTagCategory[] | undefined) || [];\n  if (!cats.length) return;\n\n  const need = new Set<string>();\n  cats.forEach((g) => (g.tagIds || []).forEach((id) => need.add(String(id))));\n\n  const have = new Set(app.store.all('tags').map((t: any) => String(t.id())));\n  const missing = [...need].some((id) => !have.has(id));\n  if (missing) await warmupTags();\n}\n","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport Button from 'flarum/common/components/Button';\nimport TagFilterModal from './components/TagFilterModal';\nimport { parseQ } from './util/query';\nimport { warmupTags, ensureCategoryTagsLoaded } from './util/tags';\n\nconst EXT_ID = 'lady-byron-tag-filter';\n\n/* ================== 滚动恢复（仅“返回”触发，等待首屏后恢复） ================== */\ntype SavedState = {\n  y: number;\n  href?: string;\n  id?: string;\n  ts: number;\n};\n\nconst SAVE_TTL_MS = 10 * 60 * 1000; // 10 分钟\nconst RESTORE_MAX_MS = 6000;        // 恢复最多尝试 6s\nconst PREFETCH_LIMIT = 6;           // 最多温和预取 6 页\n\nfunction getRouteKey(): string {\n  try {\n    const m: any = (window as any).m;\n    if (m?.route?.get) return String(m.route.get());\n  } catch {}\n  return `${location.pathname}${location.search}${location.hash || ''}`;\n}\nfunction storageKey(): string {\n  return `lbtc:scroll:${getRouteKey()}`;\n}\nfunction headerOffsetGuess(): number {\n  const el = document.querySelector('.App-header, .Header, header') as HTMLElement | null;\n  return el ? Math.max(0, el.getBoundingClientRect().height - 4) : 0;\n}\nfunction topListItem(): HTMLElement | null {\n  let topEl: HTMLElement | null = null;\n  const items = Array.from(document.querySelectorAll<HTMLElement>('li.DiscussionListItem'));\n  let minPos = Infinity;\n  const topEdge = headerOffsetGuess();\n  for (const li of items) {\n    const r = li.getBoundingClientRect();\n    if (r.bottom <= topEdge) continue;\n    if (r.top >= topEdge && r.top < minPos) {\n      topEl = li;\n      minPos = r.top;\n    }\n  }\n  return topEl;\n}\nfunction saveCurrentState() {\n  try {\n    const y = window.scrollY || document.documentElement?.scrollTop || document.body?.scrollTop || 0;\n    const el = topListItem();\n    let href: string | undefined;\n    let id: string | undefined;\n    if (el) {\n      id = el.getAttribute('data-id') || undefined;\n      const a = el.querySelector('a[href*=\"/d/\"]') as HTMLAnchorElement | null;\n      href = a?.getAttribute('href') || undefined;\n    }\n    const state: SavedState = { y, href, id, ts: Date.now() };\n    sessionStorage.setItem(storageKey(), JSON.stringify(state));\n  } catch {}\n}\nfunction parseSaved(): SavedState | null {\n  try {\n    const raw = sessionStorage.getItem(storageKey());\n    if (!raw) return null;\n    const s = JSON.parse(raw) as SavedState;\n    if (typeof s?.y !== 'number' || typeof s?.ts !== 'number') return null;\n    if (Date.now() - s.ts > SAVE_TTL_MS) return null;\n    return s;\n  } catch {\n    return null;\n  }\n}\nfunction findTargetElement(state: SavedState): HTMLElement | null {\n  if (state.id) {\n    const byId = document.querySelector<HTMLElement>(`li.DiscussionListItem[data-id=\"${state.id}\"]`);\n    if (byId) return byId;\n  }\n  if (state.href) {\n    const m = state.href.match(/\\/d\\/(\\d+)/);\n    if (m) {\n      const num = m[1];\n      const byHref =\n        document\n          .querySelector<HTMLElement>(`li.DiscussionListItem a[href*=\"/d/${num}\"]`)\n          ?.closest('li.DiscussionListItem') as HTMLElement | null;\n      if (byHref) return byHref;\n    }\n  }\n  return null;\n}\nfunction hasAnyListItems(): boolean {\n  return document.querySelector('li.DiscussionListItem') !== null;\n}\nfunction waitForFirstPaint(maxMs = 1500): Promise<void> {\n  // 等待到列表出现首个卡片（首屏渲染完毕），或超时\n  const start = performance.now();\n  return new Promise((resolve) => {\n    const tick = () => {\n      if (hasAnyListItems() || performance.now() - start > maxMs) return resolve();\n      setTimeout(tick, 50);\n    };\n    tick();\n  });\n}\nasync function gentlePrefetchUntilVisible(saved: SavedState, pageLimit = PREFETCH_LIMIT, maxMs = RESTORE_MAX_MS / 1.5) {\n  const start = performance.now();\n  const state: any = (app as any).discussions;\n  if (!state || typeof state.loadMore !== 'function') return false;\n\n  for (let i = 0; i < pageLimit; i++) {\n    if (findTargetElement(saved)) return true;\n    if (!(state.moreResults || state.hasMoreResults || state.next)) break;\n    if (state.loading) {\n      await new Promise((r) => setTimeout(r, 80));\n      i--;\n      continue;\n    }\n    try {\n      await state.loadMore();\n    } catch {\n      break;\n    }\n    await new Promise((r) => setTimeout(r, 80));\n    if (performance.now() - start > maxMs) break;\n  }\n  return !!findTargetElement(saved);\n}\nfunction scrollToAnchor(el: HTMLElement) {\n  const offset = headerOffsetGuess();\n  const y = window.scrollY + el.getBoundingClientRect().top - offset - 8;\n  window.scrollTo(0, Math.max(0, y));\n}\nfunction scrollToYIfValid(y: number) {\n  const doc = document.documentElement || document.body;\n  const maxY = Math.max(0, (doc.scrollHeight || 0) - window.innerHeight);\n  if (y <= maxY) window.scrollTo(0, y);\n}\n\n/* --------- 仅“返回”触发恢复：安装全局返回探测 --------- */\n(function installBackNavDetector() {\n  if ((window as any).__lbtcBackDetectorInstalled) return;\n  (window as any).__lbtcBackDetectorInstalled = true;\n  window.addEventListener('popstate', () => { (window as any).__lbtcShouldRestore = true; });\n  window.addEventListener('pageshow', (e: PageTransitionEvent) => {\n    if ((e as any).persisted) (window as any).__lbtcShouldRestore = true;\n  });\n  if ((window as any).__lbtcShouldRestore === undefined) (window as any).__lbtcShouldRestore = false;\n})();\n\n/* ========================= 原有功能（按钮/弹窗） ========================= */\napp.initializers.add(EXT_ID, () => {\n  function toolbarLabel(): Mithril.Children {\n    const q =\n      app.search && typeof (app.search as any).params === 'function'\n        ? ((app.search as any).params().q as string) || ''\n        : '';\n    const { tagSlugs } = parseQ(q);\n\n    if (!tagSlugs.length) {\n      return app.translator.trans('lady-byron-tag-filter.forum.toolbar.button');\n    }\n\n    const bySlug = new Map(app.store.all('tags').map((t: any) => [t.slug?.(), t]));\n    const parts: Mithril.Children[] = [];\n    tagSlugs.forEach((slug, i) => {\n      const tag = bySlug.get(slug);\n      const color = tag?.color?.() || 'var(--tag-color)';\n      const name = tag?.name?.() || slug;\n\n      parts.push(\n        <span\n          key={`tl-tag-${slug}`}\n          className=\"lbtc-tf-ToolbarTag\"\n          style={{ '--tag-title-color': color } as any}\n          data-tag-slug={slug}\n        >\n          {name}\n        </span>\n      );\n      if (i < tagSlugs.length - 1) parts.push(<span key={`tl-sep-${i}`} className=\"lbtc-tf-ToolbarSep\">{' '}</span>);\n    });\n\n    return parts;\n  }\n\n  extend(IndexPage.prototype as any, 'viewItems', function (items: any) {\n    items.add(\n      'lady-byron-tag-filter',\n      <Button\n        className=\"Button\"\n        icon=\"fas fa-filter\"\n        aria-label={app.translator.trans('lady-byron-tag-filter.forum.toolbar.button')}\n        onclick={async () => {\n          try { await ensureCategoryTagsLoaded(); } catch {}\n          app.modal.show(TagFilterModal);\n        }}\n        onmouseenter={() => warmupTags()}\n        onfocus={() => warmupTags()}\n        oncreate={() => {\n          const idle = (window as any).requestIdleCallback || ((fn: any) => setTimeout(fn, 300));\n          idle(() => warmupTags());\n        }}\n      >\n        {toolbarLabel()}\n      </Button>,\n      -15\n    );\n  });\n\n  /* ========================= 列表页：滚动恢复挂载 ========================= */\n\n  // 关闭 Page 的置顶/浏览器内部还原，由我们在“返回”场景托管\n  extend(IndexPage.prototype as any, 'oninit', function () {\n    try {\n      (this as any).scrollTopOnCreate = false;\n      (this as any).useBrowserScrollRestoration = false;\n\n      // 若是“返回”，在这一页临时禁用浏览器自动还原，避免先被放到中段\n      if ((window as any).__lbtcShouldRestore === true && 'scrollRestoration' in history) {\n        (window as any).__lbtcPrevScrollRestoration = (history as any).scrollRestoration;\n        (history as any).scrollRestoration = 'manual';\n      }\n    } catch {}\n  });\n\n  // 恢复逻辑：等待首屏出现 -> 精确锚点；失败则尝试温和预取；仍失败再用 y（合法才滚）\n  extend(IndexPage.prototype as any, 'oncreate', function () {\n    const key = storageKey();\n\n    const tryRestore = async () => {\n      if ((window as any).__lbtcShouldRestore !== true) return;\n      const saved = parseSaved();\n      if (!saved) return finish(false);\n\n      // 用户一旦主动滚动，放弃恢复（不和用户抢）\n      let aborted = false;\n      const abort = () => { aborted = true; };\n      const removeAborters = () => {\n        window.removeEventListener('wheel', abort, { capture: true } as any);\n        window.removeEventListener('touchstart', abort, { capture: true } as any);\n        window.removeEventListener('keydown', abort, { capture: true } as any);\n      };\n      window.addEventListener('wheel', abort, { capture: true, passive: true });\n      window.addEventListener('touchstart', abort, { capture: true, passive: true });\n      window.addEventListener('keydown', abort, { capture: true });\n\n      const start = performance.now();\n\n      // 1) 等首屏（避免在 0 高度时计算锚点）\n      await waitForFirstPaint(1500);\n\n      // 2) 循环尝试：锚点 -> 预取 -> y（均不滚到底）\n      let success = false;\n      while (!aborted && performance.now() - start < RESTORE_MAX_MS) {\n        const target = findTargetElement(saved);\n        if (target) {\n          scrollToAnchor(target);\n          success = true;\n          break;\n        }\n        // 首次进入或数据不够：温和预取一小段（不滚动页面）\n        const prefetched = await gentlePrefetchUntilVisible(saved, PREFETCH_LIMIT, RESTORE_MAX_MS / 1.5);\n        if (prefetched) {\n          const t2 = findTargetElement(saved);\n          if (t2) {\n            scrollToAnchor(t2);\n            success = true;\n            break;\n          }\n        }\n        // 最后用 y 尝试一次（仅当 y 合法时）\n        const offset = headerOffsetGuess();\n        const wantY = Math.max(0, (saved.y || 0) - offset);\n        const doc = document.documentElement || document.body;\n        const maxY = Math.max(0, (doc.scrollHeight || 0) - window.innerHeight);\n        if (wantY <= maxY) {\n          window.scrollTo(0, wantY);\n          success = true;\n        }\n        break;\n      }\n\n      removeAborters();\n      finish(success);\n    };\n\n    const finish = (success: boolean) => {\n      // 成功才记 restoredKey；失败让 onupdate 再试一次\n      if (success) (window as any).__lbtcRestoredKey = key;\n      (window as any).__lbtcShouldRestore = false;\n\n      // 恢复浏览器默认滚动策略\n      try {\n        if ('scrollRestoration' in history) {\n          const prev = (window as any).__lbtcPrevScrollRestoration;\n          (history as any).scrollRestoration = prev || 'auto';\n          (window as any).__lbtcPrevScrollRestoration = undefined;\n        }\n      } catch {}\n    };\n\n    // 如果本次不是“返回”，直接退出\n    if ((window as any).__lbtcShouldRestore !== true) return;\n\n    // 避免重复恢复\n    if ((window as any).__lbtcRestoredKey === key) {\n      (window as any).__lbtcShouldRestore = false;\n      tryRestore(); // 仍然确保恢复 scrollRestoration\n      return;\n    }\n\n    // 开始恢复\n    tryRestore();\n  });\n\n  // 慢网/慢机：初次没成功，渲染更新后再试一次（仍仅“返回”时）\n  extend(IndexPage.prototype as any, 'onupdate', function () {\n    if ((window as any).__lbtcShouldRestore !== true) return;\n    const key = storageKey();\n    if ((window as any).__lbtcRestoredKey === key) return;\n\n    // 触发一次轻量的再尝试\n    const saved = parseSaved();\n    if (!saved) {\n      (window as any).__lbtcShouldRestore = false;\n      return;\n    }\n    const target = findTargetElement(saved);\n    if (target) {\n      scrollToAnchor(target);\n      (window as any).__lbtcRestoredKey = key;\n      (window as any).__lbtcShouldRestore = false;\n      try {\n        if ('scrollRestoration' in history) {\n          const prev = (window as any).__lbtcPrevScrollRestoration;\n          (history as any).scrollRestoration = prev || 'auto';\n          (window as any).__lbtcPrevScrollRestoration = undefined;\n        }\n      } catch {}\n    }\n  });\n\n  // 离开时保存位置；并在进入主题的 pointerdown/click 捕获阶段先保存一次（移动端更稳）\n  extend(IndexPage.prototype as any, 'onremove', function () { saveCurrentState(); });\n\n  if (!(window as any).__lbtcScrollGuardInstalled) {\n    (window as any).__lbtcScrollGuardInstalled = true;\n    const handler = (ev: Event) => {\n      const a = (ev.target as HTMLElement | null)?.closest?.('a[href*=\"/d/\"]') as HTMLAnchorElement | null;\n      if (a) saveCurrentState();\n    };\n    document.addEventListener('pointerdown', handler, { capture: true, passive: true });\n    document.addEventListener('click', handler, { capture: true, passive: true });\n  }\n});\n"],"names":["OverloadYield","require","regenerator","regeneratorAsync","regeneratorAsyncGen","regeneratorAsyncIterator","regeneratorKeys","regeneratorValues","_regeneratorRuntime","r","e","m","t","Object","getPrototypeOf","__proto__","constructor","n","displayName","name","o","a","stop","v","abrupt","delegateYield","resultName","d","finish","f","_t","p","prev","next","sent","call","this","module","exports","wrap","w","reverse","isGeneratorFunction","mark","awrap","AsyncIterator","async","u","keys","values","__esModule","regeneratorDefine","_regenerator","Symbol","iterator","toStringTag","i","c","prototype","Generator","create","y","G","bind","length","l","TypeError","done","value","GeneratorFunction","GeneratorFunctionPrototype","setPrototypeOf","k","resolve","then","asyncIterator","runtime","regeneratorRuntime","accidentalStrictMode","globalThis","Function","Promise","_regeneratorDefine","defineProperty","_invoke","enumerable","configurable","writable","_typeof","isNaN","unshift","pop","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","getter","definition","key","get","obj","prop","hasOwnProperty","asyncGeneratorStep","_asyncToGenerator","arguments","apply","_next","_throw","flarum","core","compat","_setPrototypeOf","TagChip","tag","opts","color","selected","desc","description","type","className","style","title","onclick","slug","id","icon","tagIcon","_extends","assign","LS_KEY","saveCollapsed","map","localStorage","setItem","JSON","stringify","_unused2","parseQ","q","_step","tags","restParts","_iterator","_createForOfIteratorHelperLoose","trim","split","filter","Boolean","exec","push","rest","join","tagSlugs","Array","from","Set","TagFilterModal","_Modal","_this","_len","args","_key","concat","allTags","Stream","collapsed","initialized","localSelected","initialRest","applyTimer","_proto","app","trans","oninit","vnode","getItem","parse","_unused","loadCollapsed","all","_parseQ","params","oncreate","_this$element","closeBtn","element","querySelector","getAttribute","setAttribute","close","onremove","clearTimeout","onsubmit","preventDefault","content","_this2","LoadingIndicator","raw","keyword","toLowerCase","visible","includes","slice","cats","attribute","isArray","g","_g$order","order","Number","MAX_SAFE_INTEGER","tagIds","sort","b","_this$collapsed","_pickTagsInCategories","tagById","Map","grouped","group","inGroup","forEach","add","ungrouped","has","pickTagsInCategories","_this2$collapsed","_String","_this2$collapsed$_Str","String","__ungrouped__","header","renderHeader","redraw","sections","_ref","isCollapsed","sorted","sortTags","classList","role","tabindex","toggleGroup","onkeydown","display","toggleLocalAndApply","flat","expandAll","collapseAll","_this3","bySlug","selectedTags","s","placeholder","bidi","oninput","Button","clear","applyNow","debounce","disabled","'['","_opts$debounce","_this4","parsed","items","wait","window","setTimeout","dl","refreshParams","route","param","url","history","replaceState","setText","doApply","Modal","isDismissibleViaEscKey","isDismissibleViaBackdropClick","isDismissibleViaCloseButton","warmupPromise","warmupTags","find","include","ensureCategoryTagsLoaded","_ensureCategoryTagsLoaded","_callee","need","have","_context","some","storageKey","_m$route","location","pathname","search","hash","getRouteKey","headerOffsetGuess","el","document","Math","max","getBoundingClientRect","height","saveCurrentState","_document$documentEle","_document$body","href","scrollY","documentElement","scrollTop","body","topEl","querySelectorAll","minPos","Infinity","topEdge","_i","_items","li","bottom","top","topListItem","state","ts","Date","now","sessionStorage","parseSaved","_unused3","findTargetElement","byId","match","_document$querySelect","num","byHref","closest","waitForFirstPaint","maxMs","start","performance","tick","gentlePrefetchUntilVisible","_x","_x2","_x3","_gentlePrefetchUntilVisible","_callee3","saved","pageLimit","_context3","RESTORE_MAX_MS","loadMore","moreResults","hasMoreResults","loading","scrollToAnchor","offset","scrollTo","__lbtcBackDetectorInstalled","addEventListener","__lbtcShouldRestore","persisted","extend","IndexPage","show","onmouseenter","onfocus","requestIdleCallback","fn","parts","toolbarLabel","scrollTopOnCreate","useBrowserScrollRestoration","__lbtcPrevScrollRestoration","scrollRestoration","_unused5","tryRestore","_ref2","_callee2","aborted","abort","removeAborters","success","target","t2","wantY","doc","maxY","_context2","removeEventListener","capture","passive","scrollHeight","innerHeight","__lbtcRestoredKey","_unused6","_unused7","__lbtcScrollGuardInstalled","handler","ev","_ev$target"],"sourceRoot":""}